<!DOCTYPE html>
<html>
<head>
<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
<title>Hello : ) I'm Minjong.</title>
<link rel="icon" type="image/png" href="./general/favicon.png">
<!-- Meta Viewport -->
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Not using fontawesome anymore -->
<!-- Master stylesheet -->
<link rel="stylesheet" href="./style.css">
<link href="https://fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=PT+Serif" rel="stylesheet">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-49851605-1', 'auto');
  ga('send', 'pageview');

</script>
	<!-- Chart CSS styling starts -->
	<style>
	div, .values {
	overflow: hidden;
	z-index: 0;
	}
	.tooltips > div {
	overflow: visible;
	}
	div.tip {
	font: 300 .5em 'Lato', sans-serif;
	width: 62px;
	position: absolute;
	background-color:#fff;
	text-align: center;
	}
	.months, .tooltips {
	position:relative;
	margin: 8px;
	}
	.toolwrap {
	position: absolute;
	left:0;
	right:0;
	}
	.temp {
	font-weight: 300;
	color:#334f87;
	}
.intro.full.center {
background-size: 100%;
background-image: url('./temp_bg.png');
background-repeat: no-repeat;
background-position: center bottom;
}
	</style>
	<!-- Chart CSS styling starts -->
</head>
<body>
<div class="header">
	<a href="./index.html"><h1 class="logo">Minjong Lee</h1></a><p class="support menuon">S'more</p>
</div>
<div class="menu">
	<div class="off">
		<svg width="23" height="24" viewBox="-77 163 23 24" xmlns="http://www.w3.org/2000/svg"><path d="M-65.4 174l9.7-9.7.3-.3.4.3.6.7.4.3-.4.4-9.6 9.8 9.6 9.8.4.3-.4.4-.6.6-.4.4-.3-.4-9.7-9.8-9 9.2-.3.3-.3-.3-.7-.7-.3-.4.3-.4 9-9-9-9.3-.3-.3.3-.3.7-.7.3-.3.3.3 9 9z" fill-rule="evenodd" fill="#92bfce"/></svg>
	</div>
	<ul>
		<li><a class="list" href="http://sigfig.com" target="_blank">SigFig</a></li>
		<li><a class="list" href="./bookclip.html">Bookclip</a></li>
		<li><a class="list" href="./rigit.html">Rig-it</a></li>
		<li class="focus here"><a class="list" href="./tempvis.html">Data Vis</a></li>
		<li><a class="list" href="./rivermatters.html">Rivermatters</a></li>
<!-- 		<li><p class="list abouton">about</p></li> -->
	</ul>
	<img src="./sigfig.svg">
	<img src="./bk_int.png">
	<img src="./rigit/rigit.png">
	<img class="here" src="./tempvis.png">
	<img src="./rm_.png">
<!-- 	<img src="./minj_prfl.png"> -->
</div>
<!-- 
<div class="about">
	<div class="off"><svg width="23" height="24" viewBox="-77 163 23 24" xmlns="http://www.w3.org/2000/svg"><path d="M-65.4 174l9.7-9.7.3-.3.4.3.6.7.4.3-.4.4-9.6 9.8 9.6 9.8.4.3-.4.4-.6.6-.4.4-.3-.4-9.7-9.8-9 9.2-.3.3-.3-.3-.7-.7-.3-.4.3-.4 9-9-9-9.3-.3-.3.3-.3.7-.7.3-.3.3.3 9 9z" fill-rule="evenodd" fill="#92bfce"/></svg></div>
	<div><p>Copies about Minjong Lee will be coming soon.</p></div>
</div>
 -->
<div class="intro full center">
	<h1 class="projectna center fadein">2014 San Francisco & Pittsburgh Temperature</h1>
	<p class="sub fadein">Data Visualization</p>
	<div>
		<p class="tag">HTML/CSS</p><p class="tag">D3JS</p><p class="tag">Late 2015</p>
	</div>
</div>
<div>
	<p class="divider">Click button below to see temperature map of each city. The weather data is collected from <a href="http://w2.weather.gov/climate/" target="_blank">National Weather Service</a> and <a href="http://www.wunderground.com/history" target="_blank">Weather Underground</a>. Also, utilized <a href="https://shancarter.github.io/mr-data-converter/" target="_blank">Mr. Data Converter</a> for converting data.</p>
	<div class="center">
		<a href="https://goo.gl/7gWdfT" target="_blank">
		<p class="cta">Read Process on Medium</p>
		</a>
	</div>
	<div class="center selection">
		<p class="option" name="pitButton" type="button" value="pittsburgh" onclick="updatePitData()" />Pittsburgh</p>
		<p class="option this" name="sanButton" type="button" value="San Francisco" onclick="updateSanData()" />San Francisco</p>
	</div>
</div>

<div style="width:1280px;margin:0 auto; position:relative;">
	<div class="datavis" style="width:1280px;">
		<div class="toolwrap" style="width:1280px;overflow:visible;">
		</div>
	</div>
</div>
<div id="end">
<p class="center">Next, Read More of</p>
<a href="./rivermatters.html"><h5>Rivermatters</h5></a>
</div>
<footer>
<p class="support">Copyright 2016. Designed & Coded from scratch by Minjong Lee. Font faces used in this website are <span class="accent">Lato</span> and <span class="accent">Open Sans</span>. Also plugged in <span class="accent">slick.js</span> and <span class="accent">typed.js</span> for presentation.</p>
</footer>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.0/jquery-ui.min.js"></script>
<script src="./functions.js"></script>
<!-- D3 Chart scripting starts -->
<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script>
var w = 300,
	h = 300,
	m = [8, 8, 8, 8],
	r = 40,
	width = w - m[1] - m[3],
	height = h - m[0] - m[2],
	barHeight = 9

var dayAngle = 360/31,
	speed = 10,
	tempRegion = [-9,95]

var xRange = d3.scale.linear()
			.range([0,width/2-r])

var color = d3.scale.linear()
			.range(['#5ff0ff', '#ff6363']),
	monthColor = d3.scale.ordinal()
			.range(["#ffff00", "#b5ff00","#00ff91", "#00fff2", "#00e1ff", "#00aaff","#ffff00", "#b5ff00","#00ff91", "#00fff2", "#00e1ff", "#00aaff"])

color.domain(tempRegion);
xRange.domain(tempRegion);

var timeFormat = d3.time.format('%m/%d/%Y'),
	parseTime = timeFormat.parse,
	monthFormat = d3.time.format('%B');

d3.csv('./datavis/2014_san_temp.csv', function(error, data) {
	data.forEach(function(d) {
		d.Date = parseTime(d.Date);
		d.Max = +d.Max;
		d.Min = +d.Min;		
		});

	// Group data based on Month
	var tempPerMonth = d3.nest()
			.key(function(d) {return monthFormat(d.Date);})
			.entries(data);

	var svg = d3.select('.datavis').selectAll('div.months')
			.data(tempPerMonth)
		.enter().append('div')
			.attr('class', function(d) {return 'months ' + d.key;})
			.style('display', 'inline-block')
			.style('width', width + m[1] + m[3]+'px')
			.style('height', height + m[0] + m[2]+'px')
		.append('svg:svg')
			.attr('width', width + m[1] + m[3])
			.attr('height', height + m[0] + m[2])
		.append('svg:g')
			.attr('transform', 'translate(' + m[3] + ',' + m[0] + ')');

	// Write name of the month in the center of the chart
	svg.append('svg:text')
		.attr('class', 'monthname')
		.attr('text-anchor', 'middle')
		.attr('dx', width/2)
		.attr('dy', height/2 + 8)//8 is half of body font size
		.attr('font-weight', 300)
		.attr('fill', '#232323')//function(d) {return monthColor(d.key);}
		.text(function(d) { return d.key });

	// Set up a wrapper for the whole tooltips
	var div = d3.select('.toolwrap').selectAll('div.tooltips')
			.data(tempPerMonth)
		.enter().append('div')
			.attr('class', 'tooltips')
			.style('display', 'inline-block')
			.style('width',  width + m[1] + m[3] + 'px')
			.style('height', height + m[0] + m[2] + 'px')
			.append('div');

	// Set up individual day's tooltip
	var tips = div.selectAll('div.tip')
			.data(function(d) {return d.values;})
		.enter().append('div')
			.attr('class', 'tip')
			.attr('data-name', function(d) {return timeFormat(d.Date);})
			.style('opacity', 0)
			.style('left', w/2 -r + 10 + 'px')
			.style('top', h/2 -r + 28 +'px');

	// Add two bars of each Min and Max temperature value of the day
	var valueSvg = svg.selectAll('svg.values')
			.data(function(d) {return d.values;})
		.enter().append('svg')
			.attr('class', 'values')
			.attr('data-name', function(d) {return timeFormat(d.Date);});

	// Add bars of Maximum temperature with on mouseover and mouseout
	valueSvg.append('svg:rect')
			.attr('x', width/2 + r)
			.attr('y', height/2)
			.attr('stroke', 'white')
			.attr('height', barHeight)
			.attr('data-name', function(d) {return timeFormat(d.Date);})
			.attr('transform', function(d, i) {return 'rotate(' + dayAngle * i + ',' + width/2 + ',' + ((height/2)+(barHeight/2)) + ')'})
			.attr('fill', function(d, i) {return color(d.Max);})
			.attr('class', 'maxtemp')
			.attr('width', function(d, i) {return xRange(d.Max);})
			.on('mouseover', function(d) {
				var callDate = $(this).attr('data-name');
				var thisMonth = monthFormat(parseTime(callDate));
				$('.tooltips').find('[data-name="' + callDate + '"]').animate({opacity: 1}, speed);
				$('.' + thisMonth).find('[data-name="' + callDate + '"]').animate({opacity: 1}, speed);
				$('.' + thisMonth).find('.values:not([data-name="' + callDate + '"])').animate({opacity: .4}, speed);
				$('.' + thisMonth).find('text.monthname:contains("' + thisMonth + '")').animate({opacity:0},speed);
				tips.html(function(d) {return callDate +'<span class="temp"><br>Max: ' + d.Max + '&#8457;<br>Min: ' + d.Min + '&#8457;</span>';});
			})
			.on('mouseout', function(d) {
				var callDate = $(this).attr('data-name');
				console.log(callDate);
				var thisMonth = monthFormat(parseTime(callDate));
				$('.tooltips').find('[data-name="' + callDate + '"]').animate({opacity: 0}, speed/5);
				$('.' + thisMonth).find('[data-name="' + callDate + '"]').animate({opacity: 1}, speed/5);
				$('.' + thisMonth).find('.values:not([data-name="' + callDate + '"])').animate({opacity: 1}, speed/5);
				$('.' + thisMonth).find('text.monthname:contains("' + thisMonth + '")').animate({opacity:1},speed);
			});


	// Add bars of Minimum temperature with on mouseover and mouseout
	valueSvg.append('svg:rect')
			.attr('x', width/2 + r)
			.attr('y', height/2)
			.attr('stroke', 'white')
			.attr('height', barHeight)
			.attr('data-name', function(d) {return timeFormat(d.Date);})
			.attr('transform', function(d, i) {return 'rotate(' + dayAngle * i + ',' + width/2 + ',' + ((height/2)+(barHeight/2)) + ')'})
			.attr('fill', function(d, i) {return color(d.Min);})
			.attr('class', 'mintemp')
			.attr('width', function(d, i) {return xRange(d.Min);})
			.on('mouseover', function(d) {
				var callDate = $(this).attr('data-name');
				var thisMonth = monthFormat(parseTime(callDate));
				$('.tooltips').find('[data-name="' + callDate + '"]').animate({opacity: 1}, speed);
				$('.' + thisMonth).find('[data-name="' + callDate + '"]').animate({opacity: 1}, speed);
				$('.' + thisMonth).find('.values:not([data-name="' + callDate + '"])').animate({opacity: .4}, speed);
				$('.' + thisMonth).find('text.monthname:contains("' + thisMonth + '")').animate({opacity:0},speed);

				tips.html(function(d) {return callDate +'<span class="temp"><br>Max:  ' + d.Max + '&#8457;<br>Min: ' + d.Min + '&#8457;</span>';});
			})
			.on('mouseout', function(d) {
				var callDate = $(this).attr('data-name');
				console.log(callDate);
				var thisMonth = monthFormat(parseTime(callDate));
				$('.tooltips').find('[data-name="' + callDate + '"]').animate({opacity: 0}, speed/5);
				$('.' + thisMonth).find('[data-name="' + callDate + '"]').animate({opacity: 1}, speed/5);
				$('.' + thisMonth).find('.values:not([data-name="' + callDate + '"])').animate({opacity: 1}, speed/5);
				$('.' + thisMonth).find('text.monthname:contains("' + thisMonth + '")').animate({opacity:1},speed);
			});
});

//Update the data to Pittsburgh
function updatePitData() {
	$('div[name="pitButton"], div[name="sanButton"]').removeClass('on');
	$('div[name="pitButton"]').addClass('on');
	d3.csv('./datavis/2014_pit_temp.csv', function(error, dataset) {
		dataset.forEach(function(d) {
			d.Date = parseTime(d.Date);
			d.Max = +d.Max;
			d.Min = +d.Min;		
			});		
		console.log(dataset[0].Max);

	d3.selectAll('rect.maxtemp').data(dataset).transition()
		.attr('width', function(d) {return xRange(d.Max) + 'px';})
		.attr('fill', function(d) {return color(d.Max);});

	d3.selectAll('rect.mintemp').data(dataset).transition()
		.attr('width', function(d) {return xRange(d.Min) + 'px';})
		.attr('fill', function(d) {return color(d.Min);});

	d3.selectAll('div.tip').data(dataset).html(function(d) {return d.Date +'<span class="temp"><br>Max:  ' + d.Max + '&#8457;<br>Min: ' + d.Min + '&#8457;</span>';});
});
};

function updateSanData() {
	$('div[name="pitButton"], div[name="sanButton"]').removeClass('on');
	$('div[name="sanButton"]').addClass('on');
		d3.csv('./datavis/2014_san_temp.csv', function(error, dataset) {
		dataset.forEach(function(d) {
			d.Date = parseTime(d.Date);
			d.Max = +d.Max;
			d.Min = +d.Min;		
			});		
		console.log(dataset[0].Max);

	d3.selectAll('rect.maxtemp').data(dataset).transition()
		.attr('width', function(d) {return xRange(d.Max) + 'px';})
		.attr('fill', function(d) {return color(d.Max);});

	d3.selectAll('rect.mintemp').data(dataset).transition()
		.attr('width', function(d) {return xRange(d.Min) + 'px';})
		.attr('fill', function(d) {return color(d.Min);});

	d3.selectAll('div.tip').data(dataset).html(function(d) {return d.Date +'<span class="temp"><br>Max:  ' + d.Max + '&#8457;<br>Min: ' + d.Min + '&#8457;</span>';});
});
};
$(document).ready(function () {
	// ** Scroll Top, Process Button, Hide this **
	$('.scrolltotop').click(function() {
		$('html, body').animate({scrollTop : 0}, 1000);
		return false;
	});
});
</script>
<!-- D3 Chart scripting ends -->
</body>
</html>